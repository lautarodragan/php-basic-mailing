<?	// Connect to db...	$hDatabaseConnection = mysql_connect("localhost", "root", "123456");	mysql_select_db("mailing_tutorial", $hDatabaseConnection);		// Set connection encoding and charset. 	mysql_query("SET NAMES 'utf8'");	mysql_query("SET CHARACTER SET 'utf8'");		// Retrieve the first mail in the queue	$queryMail = mysql_query("		select * from mailings		where SendDate <= now() 			and Sent != 1		order by SendDate asc 		limit 1	");	$mail = mysql_fetch_array($queryMail);		// If all mails were alrady sent, then there's nothing to do but right now!	if (!$mail)		die ("No mails to send!");		// Get all users	$queryUsers = mysql_query("		select * from users	");		// We need the headers to allow html in the mail body. 	$headers = "From: buildfailure@wordpress.com\r\n";	$headers .= "Reply-To: buildfailure@wordpress.com \r\n";	$headers .= "MIME-Version: 1.0\r\n";	$headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";		// Loop through all users... yes, absolutely not scalable.	while ($user = mysql_fetch_array($queryUsers)) {		echo "Sending mail to {$user["MailAddress"]}, subject '{$mail["Subject"]}', body '{$mail["Body"]}' <br/>\n";		@mail($user["MailAddress"], $mail["Subject"], $mail["Body"], $headers);		// @ means not to output ugly errors, which we will get if running under Windows with no smtp.	}		// Mark the mailing we just sent as... guess.	$queryMail = mysql_query("		update mailings		set Sent = 1		where id = {$mail["Id"]}	");	?>